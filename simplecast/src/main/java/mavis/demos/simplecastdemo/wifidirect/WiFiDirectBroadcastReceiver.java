package mavis.demos.simplecastdemo.wifidirect;import android.annotation.SuppressLint;import android.content.BroadcastReceiver;import android.content.Context;import android.content.Intent;import android.net.wifi.p2p.WifiP2pManager;import android.net.wifi.p2p.WifiP2pManager.Channel;import android.net.wifi.p2p.WifiP2pManager.PeerListListener;import android.util.Log;import mavis.demos.simplecastdemo.R;/** * A BroadcastReceiver that notifies of important wifi p2p events. */public class WiFiDirectBroadcastReceiver extends BroadcastReceiver {    private final WifiP2pManager manager;    private final Channel channel;    private final WiFiDirectSetupActivity activity;    /**     * @param manager WifiP2pManager system service     * @param channel Wifi p2p channel     * @param activity activity associated with the receiver     */    public WiFiDirectBroadcastReceiver(WifiP2pManager manager, Channel channel,                                       WiFiDirectSetupActivity activity) {        super();        this.manager = manager;        this.channel = channel;        this.activity = activity;    }    @SuppressLint("MissingPermission")    @Override    public void onReceive(Context context, Intent intent) {        String action = intent.getAction();        if (WifiP2pManager.WIFI_P2P_STATE_CHANGED_ACTION.equals(action)) {            // UI update to indicate wifi p2p status.            int state = intent.getIntExtra(WifiP2pManager.EXTRA_WIFI_STATE, -1);            if (state == WifiP2pManager.WIFI_P2P_STATE_ENABLED) {                // Wifi Direct mode is enabled                activity.setIsWifiP2pEnabled(true);            } else {                activity.setIsWifiP2pEnabled(false);                activity.resetData();            }            Log.d(WiFiDirectSetupActivity.TAG, "P2P state changed - " + state);        } else if (WifiP2pManager.WIFI_P2P_PEERS_CHANGED_ACTION.equals(action)) {            if (manager != null) {                manager.requestPeers(channel, (PeerListListener) activity.getFragmentManager()                        .findFragmentById(R.id.frag_list));            }            Log.d(WiFiDirectSetupActivity.TAG, "P2P peers changed");        }    }}